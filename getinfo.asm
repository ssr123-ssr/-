
PUBLIC GETINFO

EXTRN BUF0:BYTE
EXTRN YEAR:WORD,MONTH:WORD,DAY:WORD

DATASEG SEGMENT PARA 'dat'
	P DW ?  
DATASEG ENDS

CODESEG SEGMENT PARA 'code'
	ASSUME DS:DATASEG,CS:CODESEG
	
GET MACRO REG1,REG2
	LEA DI,REG1
	MOV AX,0
L1:	MOV BL,[DI]
	SUB BL,30H
	MOV BH,0
	MOV P,10
	MUL P
	ADD AX,BX
	INC DI
	LOOP L1
	MOV MONTH,AX
ENDM
	
GETINFO PROC FAR
	PUSH DX
	PUSH AX
	PUSH BP
	MOV BP,SP
	
	mov cx,2
	GET BUF0+2,MONTH	;获得月份信息
	
	LEA DI,BUF0+4
	MOV CX,2
	MOV AX,0
L2:	MOV BL,[DI]
	SUB BL,30H
	MOV BH,0
	MOV P,10
	MUL P
	ADD AX,BX
	INC DI
	LOOP L2
	MOV DAY,AX		;获得日期信息
	
	LEA DI,BUF0+6
	MOV CX,4
	MOV AX,0
L3:	MOV BL,[DI]
	SUB BL,30H
	MOV BH,0
	MOV P,10
	MUL P
	ADD AX,BX
	INC DI
	LOOP L3
	MOV YEAR,AX		;获得年份信息
	
	POP DX
	POP AX
	POP BP
	RETF
	
GETINFO ENDP

CODESEG ENDS
END
	